function initTheme(){const e=localStorage.getItem("theme")||"dark";document.documentElement.classList.toggle("dark","dark"===e)}const disbursementsData=[{id:"DSB-2025-001",vendor:"TechSupplier Inc.",amount:45e3,currency:"USD",status:"completed",category:"vendor",method:"Bank Transfer",date:"2025-10-28",time:"14:30",description:"Hardware equipment purchase for Q4",icon:"building",gradient:"gradient-primary"},{id:"DSB-2025-002",vendor:"Office Solutions Ltd.",amount:12500,currency:"USD",status:"pending",category:"vendor",method:"ACH",date:"2025-10-29",time:"10:15",description:"Office furniture and supplies",icon:"package",gradient:"gradient-warning"},{id:"DSB-2025-003",vendor:"Global Marketing Co.",amount:28e3,currency:"USD",status:"completed",category:"vendor",method:"Wire Transfer",date:"2025-10-27",time:"16:45",description:"Q4 marketing campaign",icon:"megaphone",gradient:"gradient-success"},{id:"DSB-2025-004",vendor:"CloudHost Services",amount:8900,currency:"USD",status:"scheduled",category:"utility",method:"Bank Transfer",date:"2025-11-05",time:"09:00",description:"Monthly cloud hosting services",icon:"cloud",gradient:"gradient-cyan"},{id:"DSB-2025-005",vendor:"Employee Payroll",amount:125e3,currency:"USD",status:"completed",category:"salary",method:"ACH",date:"2025-10-25",time:"08:00",description:"October salary disbursement",icon:"users",gradient:"gradient-purple"},{id:"DSB-2025-006",vendor:"State Tax Authority",amount:34500,currency:"USD",status:"completed",category:"tax",method:"Wire Transfer",date:"2025-10-20",time:"11:30",description:"Q3 corporate tax payment",icon:"file-text",gradient:"gradient-danger"},{id:"DSB-2025-007",vendor:"Utility Power Co.",amount:4200,currency:"USD",status:"pending",category:"utility",method:"Check",date:"2025-10-30",time:"15:00",description:"Monthly electricity bill",icon:"zap",gradient:"gradient-orange"},{id:"DSB-2025-008",vendor:"Software Licensing Corp.",amount:15600,currency:"USD",status:"failed",category:"vendor",method:"Bank Transfer",date:"2025-10-26",time:"13:20",description:"Annual software licenses renewal",icon:"alert-circle",gradient:"gradient-danger"},{id:"DSB-2025-009",vendor:"Legal Services LLC",amount:22e3,currency:"USD",status:"scheduled",category:"other",method:"Wire Transfer",date:"2025-11-10",time:"14:00",description:"Legal consultation and services",icon:"briefcase",gradient:"gradient-indigo"},{id:"DSB-2025-010",vendor:"Insurance Provider Inc.",amount:18500,currency:"USD",status:"completed",category:"other",method:"ACH",date:"2025-10-24",time:"09:45",description:"Quarterly insurance premium",icon:"shield",gradient:"gradient-cyan"},{id:"DSB-2025-011",vendor:"Maintenance Services",amount:5800,currency:"USD",status:"pending",category:"utility",method:"Check",date:"2025-10-31",time:"12:00",description:"Building maintenance and repairs",icon:"wrench",gradient:"gradient-warning"},{id:"DSB-2025-012",vendor:"Consulting Group",amount:38e3,currency:"USD",status:"completed",category:"vendor",method:"Wire Transfer",date:"2025-10-22",time:"16:00",description:"Strategic consulting services",icon:"users-2",gradient:"gradient-rose"}];let disbursementChart,currentTab="all",searchQuery="",currentFilters={status:["pending","completed","scheduled","failed"],category:["vendor","salary","utility","tax","other"]};function initDisbursementChart(){const e=document.getElementById("disbursement-chart").getContext("2d"),t=document.documentElement.classList.contains("dark"),n=t?"#F1F5F9":"#0F172A";disbursementChart=new Chart(e,{type:"line",data:{labels:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],datasets:[{label:"Disbursements",data:[285e3,31e4,295e3,34e4,355e3,38e4,365e3,395e3,41e4,428e3,0,0],borderColor:"#6366F1",backgroundColor:"rgba(99, 102, 241, 0.1)",borderWidth:3,fill:!0,tension:.4,pointRadius:6,pointBackgroundColor:"#6366F1",pointBorderColor:"#fff",pointBorderWidth:2,pointHoverRadius:8}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:t?"#13151C":"#FFFFFF",titleColor:n,bodyColor:n,borderColor:t?"#1E293B":"#E2E8F0",borderWidth:1,padding:12,displayColors:!1,callbacks:{label:function(e){return"$"+e.parsed.y.toLocaleString()}}}},scales:{y:{beginAtZero:!0,grid:{color:t?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",drawBorder:!1},ticks:{color:n,callback:function(e){return"$"+e/1e3+"K"}}},x:{grid:{display:!1,drawBorder:!1},ticks:{color:n}}}}})}function renderDisbursements(){const e=document.getElementById("disbursements-container");let t=disbursementsData.filter(e=>{if(!currentFilters.status.includes(e.status))return!1;if(!currentFilters.category.includes(e.category))return!1;if(searchQuery){const t=searchQuery.toLowerCase();return e.vendor.toLowerCase().includes(t)||e.id.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)}return!0});"all"!==currentTab&&(t=t.filter(e=>e.status===currentTab)),e.innerHTML=t.map(e=>{const t="completed"===e.status?"badge-success":"pending"===e.status?"badge-warning":"scheduled"===e.status?"badge-info":"badge-danger",n={vendor:"Vendor Payment",salary:"Salary",utility:"Utility",tax:"Tax",other:"Other"}[e.category];return`\n                    <div class="disbursement-row" onclick="showDetails('${e.id}')">\n                        <div class="flex items-center gap-4 flex-1">\n                            <div class="w-12 h-12 ${e.gradient} rounded-2xl flex items-center justify-center flex-shrink-0">\n                                <i data-lucide="${e.icon}" class="w-6 h-6 text-white"></i>\n                            </div>\n                            <div class="flex-1 min-w-0">\n                                <div class="flex items-center gap-2 mb-1">\n                                    <p class="font-bold text-text">${e.vendor}</p>\n                                    <span class="badge-modern ${t}">${e.status}</span>\n                                </div>\n                                <p class="text-sm text-muted">${e.id} • ${n}</p>\n                                <p class="text-xs text-muted mt-1">${e.description}</p>\n                            </div>\n                        </div>\n\n                        <div class="text-right flex-shrink-0">\n                            <p class="text-lg font-bold text-text">${e.currency} ${e.amount.toLocaleString()}</p>\n                            <p class="text-sm text-muted">${e.method}</p>\n                            <p class="text-xs text-muted mt-1">${e.date} • ${e.time}</p>\n                        </div>\n\n                        <button class="btn-icon ml-4 flex-shrink-0" onclick="event.stopPropagation(); toggleDropdown(event, '${e.id}')">\n                            <i data-lucide="more-vertical" class="w-5 h-5"></i>\n                        </button>\n\n                        <div class="dropdown-menu" id="dropdown-${e.id}">\n                            <div class="dropdown-item" onclick="showDetails('${e.id}')">\n                                <i data-lucide="eye" class="w-4 h-4"></i>\n                                View Details\n                            </div>\n                            <div class="dropdown-item">\n                                <i data-lucide="download" class="w-4 h-4"></i>\n                                Download Receipt\n                            </div>\n                            <div class="dropdown-item">\n                                <i data-lucide="copy" class="w-4 h-4"></i>\n                                Duplicate\n                            </div>\n                            <div class="dropdown-item text-danger">\n                                <i data-lucide="trash-2" class="w-4 h-4"></i>\n                                Delete\n                            </div>\n                        </div>\n                    </div>\n                `}).join(""),document.getElementById("showing-count").textContent=t.length,document.getElementById("total-count").textContent=disbursementsData.length,lucide.createIcons()}function switchTabDisbursement(e){currentTab=e,document.querySelectorAll(".tab-btn-disbursement[data-tab]").forEach(e=>e.classList.remove("active"));const t=document.querySelector(`.tab-btn-disbursement[data-tab="${e}"]`);t&&t.classList.add("active"),updateMobileDropdownDisbursement(e),renderDisbursements()}document.querySelectorAll(".tab-btn-disbursement[data-tab]").forEach(e=>{e.addEventListener("click",()=>{switchTabDisbursement(e.dataset.tab)})});const tabDropdownBtnDisbursement=document.getElementById("tab-dropdown-btn-disbursement"),tabDropdownMobileDisbursement=document.getElementById("tab-dropdown-mobile-disbursement");if(tabDropdownBtnDisbursement&&tabDropdownMobileDisbursement){tabDropdownBtnDisbursement.addEventListener("click",e=>{e.stopPropagation(),tabDropdownMobileDisbursement.classList.toggle("open")}),document.addEventListener("click",e=>{tabDropdownMobileDisbursement.contains(e.target)||tabDropdownMobileDisbursement.classList.remove("open")});const e=document.querySelectorAll(".tab-dropdown-item-disbursement[data-tab]");e.forEach(t=>{t.addEventListener("click",n=>{n.stopPropagation();const o=t.dataset.tab;e.forEach(e=>e.classList.remove("active")),t.classList.add("active");const r=document.getElementById("tab-dropdown-text-disbursement");r&&(r.textContent=t.textContent.trim()),tabDropdownMobileDisbursement.classList.remove("open"),switchTabDisbursement(o),lucide.createIcons()})})}function updateMobileDropdownDisbursement(e){const t=document.getElementById("tab-dropdown-text-disbursement");document.querySelectorAll(".tab-dropdown-item-disbursement[data-tab]").forEach(n=>{n.dataset.tab===e?(n.classList.add("active"),t&&(t.textContent=n.textContent.trim())):n.classList.remove("active")})}function convertToCSV(e){if(0===e.length)return"";const t=e.map(e=>[e.id,e.vendor,e.amount,e.currency,e.status,e.category,e.method,e.date,e.description].map(e=>`"${e}"`).join(","));return[["ID","Vendor","Amount","Currency","Status","Category","Method","Date","Description"].join(","),...t].join("\n")}function downloadCSV(e,t){const n=new Blob([e],{type:"text/csv"}),o=window.URL.createObjectURL(n),r=document.createElement("a");r.href=o,r.download=t,r.click(),window.URL.revokeObjectURL(o)}function openModal(e){document.getElementById(e).classList.add("open"),document.body.style.overflow="hidden"}function closeModal(e){document.getElementById(e).classList.remove("open"),document.body.style.overflow=""}function toggleDropdown(e,t){e.stopPropagation();const n=document.getElementById(`dropdown-${t}`);document.querySelectorAll(".dropdown-menu").forEach(e=>{e.id!==`dropdown-${t}`&&e.classList.remove("show")}),n.classList.toggle("show")}function showDetails(e){const t=disbursementsData.find(t=>t.id===e);t&&(document.getElementById("detail-id").textContent=t.id,document.getElementById("detail-vendor").textContent=t.vendor,document.getElementById("detail-amount").textContent=`${t.currency} ${t.amount.toLocaleString()}`,document.getElementById("detail-status").textContent=t.status,document.getElementById("detail-status").className="badge-modern "+("completed"===t.status?"badge-success":"pending"===t.status?"badge-warning":"scheduled"===t.status?"badge-info":"badge-danger"),document.getElementById("detail-category").textContent={vendor:"Vendor Payment",salary:"Salary",utility:"Utility",tax:"Tax",other:"Other"}[t.category],document.getElementById("detail-method").textContent=t.method,document.getElementById("detail-date").textContent=`${t.date} at ${t.time}`,document.getElementById("detail-description").textContent=t.description,openModal("details-modal"))}function toggleFilterPanel(){document.getElementById("filter-panel").classList.toggle("translate-x-full")}function createDisbursement(){closeModal("create-disbursement-modal"),showToast("Disbursement Created","New disbursement has been scheduled successfully","success")}function showToast(e,t,n="success"){const o=document.getElementById("toast"),r=document.getElementById("toast-title"),s=document.getElementById("toast-message");r.textContent=e,s.textContent=t,o.className=`toast ${n}`,o.classList.add("show"),setTimeout(()=>o.classList.remove("show"),3e3)}function updateChartPeriod(e){showToast("Chart Updated",`Showing ${e.toUpperCase()} data`,"success")}document.getElementById("disbursement-search").addEventListener("input",e=>{searchQuery=e.target.value,renderDisbursements()}),document.querySelectorAll(".filter-checkbox").forEach(e=>{e.addEventListener("change",e=>{const t=e.target.dataset.filter;e.target.checked?["pending","completed","scheduled","failed"].includes(t)?currentFilters.status.includes(t)||currentFilters.status.push(t):["vendor","salary","utility","tax","other"].includes(t)&&(currentFilters.category.includes(t)||currentFilters.category.push(t)):["pending","completed","scheduled","failed"].includes(t)?currentFilters.status=currentFilters.status.filter(e=>e!==t):["vendor","salary","utility","tax","other"].includes(t)&&(currentFilters.category=currentFilters.category.filter(e=>e!==t)),renderDisbursements()})}),document.getElementById("export-disbursements").addEventListener("click",()=>{downloadCSV(convertToCSV(disbursementsData),"disbursements-export.csv"),showToast("Export Complete","Disbursements exported successfully","success")}),document.querySelectorAll(".modal").forEach(e=>{e.addEventListener("click",t=>{t.target===e&&(e.classList.remove("open"),document.body.style.overflow="")})}),document.addEventListener("click",()=>{document.querySelectorAll(".dropdown-menu").forEach(e=>{e.classList.remove("show")})}),document.addEventListener("DOMContentLoaded",()=>{initTheme(),setTimeout(()=>{initDisbursementChart()},100),renderDisbursements(),lucide.createIcons()});