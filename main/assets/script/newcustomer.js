function toggleSidebar(){const e=document.getElementById("sidebar"),t=document.getElementById("header"),n=document.getElementById("main-content");e.classList.toggle("collapsed"),t.classList.toggle("collapsed"),n.classList.toggle("collapsed")}function toggleSubmenu(e){const t=e.nextElementSibling;e.classList.toggle("expanded"),t.classList.toggle("open")}function switchTabNewCustomer(e){document.querySelectorAll(".tab-button").forEach(e=>{e.classList.remove("active")}),document.querySelectorAll(".tab-content").forEach(e=>{e.classList.remove("active")}),document.querySelector(`[data-tab="${e}"]`).classList.add("active"),document.getElementById(e).classList.add("active"),updateProgress()}function updateProgress(){const e=["basic-info","business-info","billing-info","settings"],t=document.querySelector(".tab-content.active").id,n=(e.indexOf(t)+1)/e.length*100;document.getElementById("progress-fill")&&(document.getElementById("progress-fill").style.width=n+"%")}function toggleSwitch(e){e.classList.toggle("active")}function toggleBillingAddress(){const e=document.getElementById("same-as-contact"),t=document.getElementById("billing-address-fields");e.checked?(t.style.display="none",document.getElementById("billing-address").value=document.getElementById("address").value,document.getElementById("billing-city").value=document.getElementById("city").value,document.getElementById("billing-state").value=document.getElementById("state").value,document.getElementById("billing-zip").value=document.getElementById("zip").value,document.getElementById("billing-country").value=document.getElementById("country").value):t.style.display="grid"}function handleAvatarUpload(e){const t=e.target.files[0];if(t){if(t.size>5242880)return void showToast("File Too Large","Please select an image under 5MB","error");const e=new FileReader;e.onload=function(e){document.getElementById("avatar-preview").innerHTML=`<img src="${e.target.result}" alt="Avatar">`,showToast("Photo Updated","Profile picture uploaded successfully","success")},e.readAsDataURL(t)}}function handleDragOver(e){e.preventDefault(),document.getElementById("upload-area").classList.add("dragging")}function handleDragLeave(e){e.preventDefault(),document.getElementById("upload-area").classList.remove("dragging")}function handleDrop(e){e.preventDefault(),document.getElementById("upload-area").classList.remove("dragging"),processFiles(e.dataTransfer.files)}function handleFileUpload(e){processFiles(e.target.files)}function processFiles(e){const t=document.getElementById("uploaded-files");Array.from(e).forEach(e=>{if(e.size>10485760)return void showToast("File Too Large",`${e.name} exceeds 10MB limit`,"error");const n=document.createElement("div");n.style.cssText="display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 12px;";const o=getFileIcon(e.name);n.innerHTML=`\n                    <i data-lucide="${o}" class="w-5 h-5" style="color: var(--primary);"></i>\n                    <div style="flex: 1; min-width: 0;">\n                        <p style="font-size: 13px; font-weight: 600; color: var(--text); overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${e.name}</p>\n                        <p style="font-size: 12px; color: var(--muted);">${formatFileSize(e.size)}</p>\n                    </div>\n                    <button onclick="this.parentElement.remove()" class="btn-icon" style="width: 32px; height: 32px;">\n                        <i data-lucide="x" class="w-4 h-4"></i>\n                    </button>\n                `,t.appendChild(n),lucide.createIcons()}),showToast("Files Uploaded",`${e.length} file(s) uploaded successfully`,"success")}function getFileIcon(e){return{pdf:"file-text",doc:"file-text",docx:"file-text",jpg:"image",jpeg:"image",png:"image",gif:"image"}[e.split(".").pop().toLowerCase()]||"file"}function formatFileSize(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]}function updateSummary(){const e=document.getElementById("customer-type");document.getElementById("summary-type").textContent=e.options[e.selectedIndex].text;const t=document.getElementById("customer-status");document.getElementById("summary-status").textContent=t.options[t.selectedIndex].text;const n=document.getElementById("priority");document.getElementById("summary-priority").textContent=n.options[n.selectedIndex].text;const o=document.getElementById("credit-limit").value;document.getElementById("summary-credit").textContent=o?`$${parseFloat(o).toLocaleString()}`:"$0.00"}function validateForm(){let e=!0;["first-name","last-name","email","phone","address"].forEach(t=>{const n=document.getElementById(t);n.value.trim()?n.style.borderColor="var(--border)":(n.style.borderColor="var(--danger)",e=!1)});const t=document.getElementById("email");return t.value&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.value)&&(t.style.borderColor="var(--danger)",e=!1,showToast("Invalid Email","Please enter a valid email address","error")),e}function saveCustomer(){if(!validateForm())return showToast("Validation Error","Please fill in all required fields","error"),void switchTabNewCustomer("basic-info");const e={firstName:document.getElementById("first-name").value,lastName:document.getElementById("last-name").value,email:document.getElementById("email").value,phone:document.getElementById("phone").value,dob:document.getElementById("dob").value,gender:document.getElementById("gender").value,address:document.getElementById("address").value,city:document.getElementById("city").value,state:document.getElementById("state").value,zip:document.getElementById("zip").value,country:document.getElementById("country").value,companyName:document.getElementById("company-name").value,companyReg:document.getElementById("company-reg").value,industry:document.getElementById("industry").value,companySize:document.getElementById("company-size").value,revenue:document.getElementById("revenue").value,website:document.getElementById("website").value,taxId:document.getElementById("tax-id").value,currency:document.getElementById("currency").value,paymentTerms:document.getElementById("payment-terms").value,creditLimit:document.getElementById("credit-limit").value,paymentMethod:document.getElementById("payment-method").value,customerType:document.getElementById("customer-type").value,customerStatus:document.getElementById("customer-status").value,priority:document.getElementById("priority").value,accountManager:document.getElementById("account-manager").value,tags:document.getElementById("tags").value,notes:document.getElementById("notes").value};console.log("Customer Data:",e),setTimeout(()=>{showToast("Customer Created","New customer has been added successfully","success"),setTimeout(()=>{window.location.href="customer-list.html"},2e3)},500)}function showToast(e,t,n="success"){const o=document.getElementById("toast"),a=document.getElementById("toast-title"),l=document.getElementById("toast-message");a&&l&&o&&(a.textContent=e,l.textContent=t,o.className=`toast ${n}`),o&&(o.classList.add("show"),setTimeout(()=>o.classList.remove("show"),3e3))}document.addEventListener("DOMContentLoaded",()=>{["customer-type","customer-status","priority"].forEach(e=>{document.getElementById(e)&&document.getElementById(e).addEventListener("change",updateSummary)}),document.getElementById("credit-limit").addEventListener("input",updateSummary)});const tabDropdownBtnAnalytics=document.getElementById("tab-dropdown-btn-analytics"),tabDropdownMobileAnalytics=document.getElementById("tab-dropdown-mobile-analytics");if(tabDropdownBtnAnalytics&&tabDropdownMobileAnalytics){tabDropdownBtnAnalytics.addEventListener("click",e=>{e.stopPropagation(),tabDropdownMobileAnalytics.classList.toggle("open")}),document.addEventListener("click",e=>{tabDropdownMobileAnalytics.contains(e.target)||tabDropdownMobileAnalytics.classList.remove("open")});const e=document.querySelectorAll(".tab-dropdown-item-analytics[data-tab]");e.forEach(t=>{t.addEventListener("click",n=>{n.stopPropagation();const o=t.dataset.tab;e.forEach(e=>e.classList.remove("active")),t.classList.add("active");const a=document.getElementById("tab-dropdown-text-analytics");a&&(a.textContent=t.textContent.trim()),tabDropdownMobileAnalytics.classList.remove("open"),switchTabNewCustomer(o),lucide.createIcons()})})}function updateMobileDropdownAnalytics(e){const t=document.getElementById("tab-dropdown-text-analytics");document.querySelectorAll(".tab-dropdown-item-analytics[data-tab]").forEach(n=>{n.dataset.tab===e?(n.classList.add("active"),t&&(t.textContent=n.textContent.trim())):n.classList.remove("active")})}document.addEventListener("DOMContentLoaded",()=>{updateProgress(),lucide.createIcons(),document.querySelectorAll(".form-input, .form-select, .form-textarea").forEach(e=>{e.addEventListener("focus",function(){this.style.borderColor="var(--primary)"}),e.addEventListener("blur",function(){this.hasAttribute("required")&&!this.value.trim()?this.style.borderColor="var(--danger)":this.style.borderColor="var(--border)"})})});